$(function(a){a(".flexslider").flexslider({directionNav:!0,pauseOnAction:!1}),a(".show").click(function(){var s="显示全部"==a(this).find("a").html()?"收起":"显示全部";a(this).find("a").html(s),a(this).prev().toggleClass("extend")}),a(".casa a").click(function(){a(".casa a").removeClass(),a(this).addClass("active")})}),window.onload=function(){$(window).scroll(function(){$(this).scrollTop()<=100&&$("#toTop").hide(),0!=$(this).scrollTop()&&$("#toTop").show();var s=$(window).scrollTop(),t=$(document).height(),i=$(window).height();170>t-i-s?(a.nextpage(),$("#toTop").css({position:"#absolute",bottom:"330px"}),$("#advice").css({position:"#absolute",bottom:"286px"}),$("#qrcode").css({position:"#absolute",bottom:"242px"})):($("#toTop").css({position:"#fixed",bottom:"138px"}),$("#advice").css({position:"#fixed",bottom:"94px"}),$("#qrcode").css({position:"#fixed",bottom:"50px"}))}),$("#toTop").click(function(a){$("html,body").animate({scrollTop:"0px"},666)});var a=new Vue({el:"#app",data:{city:7,areas:[],checkareas:[],casas:[],casa:null,page:1,loading:!1},ready:function(){this.getareas()},methods:{selcity:function(a){this.city=a,this.getareas()},selarea:function(a){var s=a.area.id,t=a.$index;$(".area li:eq("+t+") a").toggleClass("active");var i=this.checkareas.indexOf(s);-1==i?this.checkareas.push(s):this.checkareas.splice(i,1),this.getCasas()},getareas:function(){this.checkareas=[],a=this,$.getJSON("/api/areas/"+a.city,function(s){a.areas=s,this.getCasas()}.bind(a))},getCasas:function(){var a=this;$("#test").css("display","none"),$(".no-more").css("display","none"),$(".loader").css("display","block");var s=a.checkareas.toString();$.getJSON("/api/casas/city/"+a.city+"/areas/"+s,function(s){a.casas=s.data,$(".loader").css("display","none"),$("#test").css("display","block")}.bind(a))},nextpage:function(){if(!this.loading){var a=this;$(".loader").css("display","block");var s=a.checkareas.toString();a.page++,$.getJSON("/api/casas/city/"+a.city+"/areas/"+s+"?page="+a.page,function(s){0==s.data.length&&$(".no-more").css("display","block");for(var t=0;t<s.data.length;t++)a.casa=s.data[t],a.casas.push(a.casa),a.casa=null;$(".loader").css("display","none"),a.loading=!1}.bind(a)),a.loading=!0}}}})};