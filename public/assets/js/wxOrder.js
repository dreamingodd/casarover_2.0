function total(){totals=0,price=0,counts=0,$(".room").each(function(){"block"==$(this).children(".quantity").css("display")&&(counts=$(this).find(".room_quantity").html(),price=$(this).find(".price").html().replace("￥",""),totals+=parseFloat(counts)*parseFloat(price),console.log(totals))}),$("#totalPayment").html(totals)}$(function(){$(".detail").click(function(){$(this).next().toggle(),$(this).children("span").children("em").toggle(),total()}),$(".reduce").click(function(){var t=parseInt($(this).parents(".room").find(".room_quantity").html());return 1>=t?0:($(this).parents(".room").find(".room_quantity").html(--t),void total())}),$(".add").click(function(){var t=parseInt($(this).parents(".room").find(".room_quantity").html());$(this).parents(".room").find(".room_quantity").html(++t),total()}),$("#submitBtn").click(function(){var t=[];$(".room").each(function(){if("block"==$(this).children(".quantity").css("display")){var o={};o.id=$(this).attr("db_id"),o.name=$(this).find(".room_name").html(),o.quantity=$(this).find(".room_quantity").html(),t.push(o)}}),console.log("Rooms INFO:"+JSON.stringify(t)),$.ajax({type:"post",url:"/wx/order/create",dataType:"json",data:{reservedRooms:t},headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(t){console.log("order create successfully!"),location.href="/wx/pay/wxorder/"+t.orderId},error:function(t){console.log(t.responseText),alert("订单创建失败！\nERROR INFO:\n"+t.responseText)}})})});